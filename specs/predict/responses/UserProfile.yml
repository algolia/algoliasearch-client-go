userProfile:
  type: object
  required:
    - user
  properties:
    user:
      type: string
    predictions:
      type: object
      title: predictions
      properties:
        funnel_stage:
          $ref: '#/predictionsFunnelStage'
        order_value:
          $ref: '#/predictionsOrderValue'
        affinities:
          $ref: '#/predictionsAffinities'
    properties:
      type: object
      title: properties
      description: Properties for the user profile.
      properties:
        raw:
          type: object
          description: Raw user properties (key-value pairs).
        computed:
          type: object
          description: Computed user properties (key-value pairs).
        custom:
          type: object
          description: Custom user properties (key-value pairs).
    segments:
      type: object
      title: segments
      required:
        - computed
        - custom
      description: Segments that the user belongs to.
      properties:
        computed:
          type: array
          description: List of computed segments IDs.
          items:
            type: string
        custom:
          type: array
          description: List of custom segments IDs.
          items:
            type: string

error:
  type: object
  description: The error when the model is not available.
  properties:
    error:
      type: string
  required:
    - error

predictionsFunnelStage:
  oneOf:
    - $ref: '#/predictionsFunnelStageSuccess'
    - $ref: '#/error'

predictionsFunnelStageSuccess:
  type: object
  description: Prediction for the **funnel_stage** model.
  properties:
    value:
      type: array
      items:
        title: funnel_stage
        type: object
        properties:
          name:
            type: string
          probability:
            type: number
            format: double
            minimum: 0
            maximum: 1
        required:
          - name
          - probability
    lastUpdatedAt:
      type: string
  required:
    - value
    - lastUpdatedAt

predictionsOrderValue:
  oneOf:
    - $ref: '#/predictionsOrderValueSuccess'
    - $ref: '#/error'

predictionsOrderValueSuccess:
  type: object
  description: Prediction for the **order_value** model.
  properties:
    value:
      type: number
      format: double
      minimum: 0
    lastUpdatedAt:
      type: string
  required:
    - value
    - lastUpdatedAt

predictionsAffinities:
  oneOf:
    - $ref: '#/predictionsAffinitiesSuccess'
    - $ref: '#/error'

predictionsAffinitiesSuccess:
  type: object
  description: Prediction for the **affinities** model.
  properties:
    value:
      type: array
      items:
        title: affinity
        type: object
        properties:
          name:
            type: string
          value:
            $ref: '#/predictionAffinityValue'
          probability:
            type: number
            format: double
            minimum: 0
            maximum: 1
        required:
          - name
          - value
          - probability
    lastUpdatedAt:
      type: string
  required:
    - value
    - lastUpdatedAt

predictionAffinityValue:
  oneOf:
    - type: string
    - type: number
      format: double
    - type: boolean
