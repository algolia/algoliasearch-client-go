post:
  operationId: fetchUserProfile
  description: Get predictions, properties (raw, computed or custom) and segments (computed or custom) for a user profile.
  summary: Get user profile.
  parameters:
    - $ref: '../common/parameters.yml#/userID'
  requestBody:
    required: true
    content:
      application/json:
        schema:
          title: params
          type: object
          description: Object with models and types to retrieve.
          additionalProperties: false
          properties:
            modelsToRetrieve:
              type: array
              description: List with model types for which to retrieve predictions.
              items:
                $ref: '../common/enums.yml#/modelsToRetrieve'
            typesToRetrieve:
              type: array
              description: List with types to be retrieved.
              items:
                $ref: '../common/enums.yml#/typesToRetrieve'
              minItems: 1
  responses:
    '200':
      description: OK
      content:
        application/json:
          schema:
            title: fetchUserProfileResponse
            type: object
            required:
              - user
            properties:
              user:
                type: string
              predictions:
                type: object
                title: predictions
                properties:
                  funnel_stage:
                    type: object
                    description: Prediction for the **funnel_stage** model.
                    properties:
                      value:
                        type: array
                        items:
                          title: funnel_stage
                          type: object
                          properties:
                            name:
                              type: string
                            probability:
                              type: number
                              minimum: 0
                              maximum: 1
                      lastUpdatedAt:
                        type: string
                  order_value:
                    type: object
                    description: Prediction for the **order_value** model.
                    properties:
                      value:
                        type: number
                        minimum: 0
                      lastUpdatedAt:
                        type: string
                  affinities:
                    type: object
                    description: Prediction for the **affinities** model.
                    properties:
                      value:
                        type: array
                        items:
                          title: affinities
                          type: object
                          properties:
                            name:
                              type: string
                            value:
                              type: string
                            probability:
                              type: number
                              minimum: 0
                              maximum: 1
                      lastUpdatedAt:
                        type: string
              properties:
                type: object
                title: properties
                description: Properties for the user profile.
                properties:
                  raw:
                    type: object
                    description: Raw user properties (key-value pairs).
                  computed:
                    type: object
                    description: Computed user properties (key-value pairs).
                  custom:
                    type: object
                    description: Custom user properties (key-value pairs).
              segments:
                type: object
                title: segments
                description: Segments that the user belongs to.
                properties:
                  computed:
                    type: array
                    description: List of computed segments IDs.
                    items:
                      type: string
                  custom:
                    type: array
                    description: List of custom segments IDs.
                    items:
                      type: string
    '404':
      $ref: '../responses/UserNotFound.yml'
    '405':
      $ref: '../../common/responses/MethodNotAllowed.yml'
    '400':
      description: ModelsToRetrieve or typesToRetrieve must be set.
      content:
        application/json:
          schema:
            $ref: '../../common/schemas/ErrorBase.yml'
